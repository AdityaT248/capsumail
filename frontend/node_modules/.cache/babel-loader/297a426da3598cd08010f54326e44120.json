{"ast":null,"code":"var _jsxFileName = \"/Users/aditya.thakkar/Documents/TimeCapsule/frontend/src/pages/Login.js\";\nimport React, { useState, useEffect } from 'react';\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nconst Login = () => {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [loginSuccess, setLoginSuccess] = useState(false);\n  const {\n    login,\n    isAuthenticated\n  } = useAuth();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  // Check if already authenticated and redirect if needed\n  useEffect(() => {\n    var _location$state;\n    if (isAuthenticated && !loading && !((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.fromLogout)) {\n      navigate('/dashboard');\n    }\n  }, [isAuthenticated, loading, navigate, location]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    try {\n      const user = await login(email, password);\n      console.log(\"Login successful, user data:\", user);\n      setLoginSuccess(true);\n\n      // Use a longer delay to ensure state updates are processed\n      setTimeout(() => {\n        console.log(\"Redirecting to dashboard now, auth state:\", isAuthenticated);\n        navigate('/dashboard', {\n          replace: true\n        });\n      }, 1000);\n    } catch (err) {\n      setError('Failed to log in. Please check your credentials.');\n      console.error(\"Login error details:\", err);\n      setLoginSuccess(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"auth-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 9\n    }\n  }, \"Log In\"), error && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 19\n    }\n  }, error), loginSuccess && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 26\n    }\n  }, \"Login successful! Redirecting...\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"email\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 13\n    }\n  }, \"Email\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"email\",\n    id: \"email\",\n    value: email,\n    onChange: e => setEmail(e.target.value),\n    required: true,\n    disabled: loginSuccess,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }\n  }, \"Password\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    id: \"password\",\n    value: password,\n    onChange: e => setPassword(e.target.value),\n    required: true,\n    disabled: loginSuccess,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-primary\",\n    disabled: loading || loginSuccess,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 11\n    }\n  }, loading ? 'Logging in...' : loginSuccess ? 'Logged In' : 'Log In')), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"auth-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, \"Don't have an account? \", /*#__PURE__*/React.createElement(Link, {\n    to: \"/register\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 34\n    }\n  }, \"Sign Up\"))));\n};\nexport default Login;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","useLocation","useAuth","Login","email","setEmail","password","setPassword","loading","setLoading","error","setError","loginSuccess","setLoginSuccess","login","isAuthenticated","navigate","location","_location$state","state","fromLogout","handleSubmit","e","preventDefault","user","console","log","setTimeout","replace","err","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","htmlFor","type","id","value","onChange","target","required","disabled","to"],"sources":["/Users/aditya.thakkar/Documents/TimeCapsule/frontend/src/pages/Login.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\n\nconst Login = () => {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [loginSuccess, setLoginSuccess] = useState(false);\n  \n  const { login, isAuthenticated } = useAuth();\n  const navigate = useNavigate();\n  const location = useLocation();\n  \n  // Check if already authenticated and redirect if needed\n  useEffect(() => {\n    if (isAuthenticated && !loading && !location.state?.fromLogout) {\n      navigate('/dashboard');\n    }\n  }, [isAuthenticated, loading, navigate, location]);\n  \n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    \n    try {\n      const user = await login(email, password);\n      console.log(\"Login successful, user data:\", user);\n      setLoginSuccess(true);\n      \n      // Use a longer delay to ensure state updates are processed\n      setTimeout(() => {\n        console.log(\"Redirecting to dashboard now, auth state:\", isAuthenticated);\n        navigate('/dashboard', { replace: true });\n      }, 1000);\n    } catch (err) {\n      setError('Failed to log in. Please check your credentials.');\n      console.error(\"Login error details:\", err);\n      setLoginSuccess(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n  \n  return (\n    <div className=\"container\">\n      <div className=\"auth-container\">\n        <h2>Log In</h2>\n        \n        {error && <div className=\"error\">{error}</div>}\n        {loginSuccess && <div className=\"success\">Login successful! Redirecting...</div>}\n        \n        <form onSubmit={handleSubmit}>\n          <div className=\"form-group\">\n            <label htmlFor=\"email\">Email</label>\n            <input\n              type=\"email\"\n              id=\"email\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              required\n              disabled={loginSuccess}\n            />\n          </div>\n          \n          <div className=\"form-group\">\n            <label htmlFor=\"password\">Password</label>\n            <input\n              type=\"password\"\n              id=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              required\n              disabled={loginSuccess}\n            />\n          </div>\n          \n          <button \n            type=\"submit\" \n            className=\"btn btn-primary\" \n            disabled={loading || loginSuccess}\n          >\n            {loading ? 'Logging in...' : loginSuccess ? 'Logged In' : 'Log In'}\n          </button>\n        </form>\n        \n        <div className=\"auth-footer\">\n          Don't have an account? <Link to=\"/register\">Sign Up</Link>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}